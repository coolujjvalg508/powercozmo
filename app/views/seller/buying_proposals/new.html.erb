<div class="page page-forms-elements page-dashboard">
	<ol class="breadcrumb breadcrumb-small">
		<li><a href="<%= seller_dashboard_path %>">Home</a></li>
		<li class="active">Submit Proposal</li>
	</ol>
	
	<div class="page-wrap">
		
		<div class="row">
			<!-- dashboard header -->
			<div class="col-md-12">
				<div class="dash-head clearfix mb20">
					<div class="left">
						<h4 class="mb5 text-light">Submit Proposal</h4>
					</div>
				</div>
			</div>
		</div> <!-- #end row -->
		
		<!-- row -->
		<div class="row">
			<section class="content myprofile-content">
		
<%= form_for @buying_proposal, url: seller_buying_proposals_path do |f|%>
	<%= f.hidden_field :status, value: 'New'%>
    <%= f.hidden_field :user_id, value: current_user.id%>
    <%= f.hidden_field :buying_request_id, value: @buying_request.id%>
				
				<div class="col-sm-12 col-md-12">
					<div class="panel panel-default panel-hovered panel-stacked mb30">
						<div class="panel-body">
							
							<div class="form-group">
								<label class="col-md-4 control-label text-bold">Buying Request Name<sup>*</sup></label>
								<div class="col-md-8">
									<input type="text" class="form-control" value="<%= @buying_request.title%>" disabled>
								</div>
							</div>
														
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<label class="col-md-4 control-label text-bold">Buying Request Serial Number<sup>*</sup></label>
								<div class="col-md-8">
									<input type="text" class="form-control" value="<%= @buying_request.identifier%>" disabled>
								</div>
							</div>							
							
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<label class="col-md-4 control-label text-bold">Price<sup>*</sup></label>
								<div class="col-md-8">
									<%= f.text_field :price, placeholder: 'Enter Price', class: 'form-control'%>
									<%= error_message(@buying_proposal, :price)%>
								</div>
							</div>
														
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<label class="col-md-4 control-label text-bold">Currency<sup>*</sup></label>
								<div class="col-md-8">
									<% currency_id = f.object.currency_id %>
									<%= f.select :currency_id, options_for_select(Currency.active.select(:symbol, :id, :name).map{|x| [raw(x.symbol)+" (#{x.name})", x.id]}, currency_id), prompt: 'Select Currency*'%>
									<%= error_message(@buying_proposal, :currency_id)%>
								</div>
							</div>	
							
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<label class="col-md-4 control-label text-bold">Delivery Time<sup>*</sup></label>
								<div class="col-md-8">
									<%= f.select :delivery_time, options_for_select([['Select Delivery time*','']]+(1..3).collect { |week| [week.to_s+" Week".pluralize(week)]  }+(1..24).collect { |month| [month.to_s+" Month".pluralize(month)]  }, selected: f.object.delivery_time) %>
									<%= error_message(@buying_proposal, :delivery_time)%>
								</div>
							</div>
							
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<label class="col-md-4 control-label text-bold">Proposal<sup>*</sup></label>
								<div class="col-md-8">
									<%= f.text_area :proposal, placeholder: 'Proposal', class: 'form-control'%>
									<%= error_message(@buying_proposal, :proposal)%>
								</div>
							</div>
							
							<div class="clearfix"></div>
							
							<div class="form-group mt20">
								<div class="col-md-12">
									<a href="javascript:void(0)">
									  <span class="label label-primary attch-btn" id="attach-btn"><i class="fa fa-paperclip"></i> Attachment</span>
										<%= f.file_field :attachment , style: "display:none;", id: "hidden-attach"%>
										<%= f.hidden_field :attachment_cache %>
									 </a>
								</div>
								<div class="col-md-12">
									<span id="propsal-file"><%=@buying_request.attachment? ? @buying_request.attachment.filename : "" %></span>
								</div>
								<div class="col-md-12">
									<span class="max-limit">Max.32MB</span>
								</div>
							</div>
													
							<div class="clearfix mt20 right">
							   <button type="submit" class="btn btn-primary mr5" value="Submit" name="commit">Submit</button>
							</div>
										
						</div>	
					</div>	
				</div>
<% end %>		
				
			</section>
		</div>
	</div>
</div>

<style type="text/css">
  .error-msg{
    color: #cc0000;
    font-size: 12px;
  }

  #filePhoto{
    opacity: 0;
    width: 100px;
    height: 100px;
    margin-top: -100px;
  }
  .add-propose-img{
    width: 100px;
    float: left;
    height: 100px;
  }
</style>
<script type="text/javascript">
  $(document).ready(function(){
    $('.upload-photo').click(function(){
      $('#filePhoto').trigger('click');
    })
    $("input[name='buying_proposal[attachment]']").change(function(e){
      var fileName = e.target.files[0].name;
      $("#propsal-file").text(fileName);
    });
    if($("#buying_proposal_attachment_cache").val()){
      arr = $("#buying_proposal_attachment_cache").val().split('/');
      fileName = arr[arr.length - 1];
      $("#propsal-file").text(fileName);
    }

    // $('#buying_proposal_delivery_time').datetimepicker({
    //   format: 'DD-MM-YYYY hh:mm a',
    //   useCurrent: false,
    //   minDate: moment().valueOf()
    // });
    $( "#attach-btn" ).on( "click", function() {
      $('#hidden-attach').click();
    });
  })

  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function (e) {
        $('#buy_image').attr('src', e.target.result);
      }
      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
